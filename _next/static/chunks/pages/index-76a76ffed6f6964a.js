(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(2627)}])},2627:function(e,n,t){"use strict";t.r(n),t.d(n,{Repl:function(){return Repl},Textarea:function(){return Textarea},default:function(){return Page}});var l=t(5893),o=t(7294),s=t(9046),u=t(7401),a=t(2397),r=t.n(a);let c="s3://".concat("duckdb-wasm-test"),i=[].concat(...["1e5","2e5","5e5","1e6","2e6","4e6","6e6"].map(e=>["".concat(c,"/").concat(e,".duckdb"),"".concat(c,"/").concat(e,"-idx.duckdb")])),d="duckdb-query",f="select count(*) from crashes",b=i[0];function Textarea(e){let{title:n,storageKey:t,defaultValue:o="",value:s,setValue:a,onChange:c,...i}=e;if(void 0===s||void 0===a){if(void 0===s&&void 0===a)[s,a]=(0,u.Z)(t,{defaultValue:o});else throw Error("either both value and setValue must be defined or neither")}return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h2",{children:n}),(0,l.jsx)("textarea",{className:r().query,value:s,onChange:e=>{c&&c(e);let n=e.target.value;a&&a(n)},...i})]})}function Repl(){let[e,n]=(0,u.Z)("duckdb-db-url",{defaultValue:b}),[t,a]=(0,o.useState)(null),[c,h]=(0,u.Z)(d,{defaultValue:f}),[x,_]=(0,u.Z)("duckdb-result",{defaultValue:null}),[g,m]=(0,o.useState)(!1);(0,o.useEffect)(()=>{console.log("initializing db:",e),(0,s.Vx)({path:e}).then(e=>{console.log("setting new db"),a(e)})},[e]);let p=(0,o.useCallback)(()=>{if(!t){console.error("no db");return}c&&(_(null),console.log("running query:",c),(0,s.Vn)(t,c).then(e=>{console.log("result:",e),_(e)}))},[t,c]),j=(0,o.useCallback)(()=>{c&&(console.log("running all:",c),m(!0),Promise.all(i.map(e=>{let n=e.split("/").pop();return(0,s.Vx)({path:e}).then(e=>(console.log("got db:",n),(0,s.Vn)(e,c))).then(e=>(console.log("db ".concat(n," result:"),e),[n,e]))})).then(e=>{let n=Object.fromEntries(e);console.log("done:",n),_(n),m(!1)}))},[c]);return(0,o.useEffect)(()=>{console.log("db effect:",t),t&&p()},[t]),(0,l.jsxs)("div",{className:r().main,children:[(0,l.jsx)("div",{className:r().row,children:(0,l.jsx)("select",{className:r().dbUrl,value:e,onChange:e=>{let t=e.target.value;console.log("new db:",t),n(t),a(null),_(null)},children:i.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})}),(0,l.jsx)("div",{className:r().row,children:(0,l.jsx)(Textarea,{title:"Query",className:r().query,value:c,setValue:h,storageKey:d,defaultValue:f,onKeyDown:e=>{"Enter"===e.code&&e.shiftKey&&(e.preventDefault(),p())}})}),(0,l.jsxs)("div",{className:r().row,children:[(0,l.jsx)("button",{type:"button",className:r().button,onClick:()=>{p()},children:"Run"}),(0,l.jsx)("button",{type:"button",className:r().button,disabled:g,onClick:()=>{j()},children:"Run all"})]}),(0,l.jsxs)("div",{className:r().row,children:[(0,l.jsx)("h2",{children:"Result"}),(0,l.jsx)("pre",{children:x&&t&&JSON.stringify(x,null,2)})]})]})}function Page(){let[e,n]=(0,o.useState)(null);return(0,o.useEffect)(()=>{console.log("setting body"),n((0,l.jsx)(Repl,{}))},[]),e}},2397:function(e){e.exports={main:"index_main__c2BVR",row:"index_row__4sXrQ",dbUrl:"index_dbUrl__k88pf",query:"index_query__i3MnC",button:"index_button__m1jEP"}}},function(e){e.O(0,[592,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);